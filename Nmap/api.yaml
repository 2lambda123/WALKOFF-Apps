walkoff: '0.1'
info:
  version: 1.0.0
  title: Nmap
  description: A simple app to interact with Nmap
  contact:
    name: Walkoff Team
  license:
    name: Creative Commons
actions:
  add_host_to_whitelist:
    run: main.Main.add_host_to_whitelist
    description: Adds a single host to the whitelist of connected hosts
    parameters:
      - name: host
        required: true
        type: string
  add_host_to_blacklist:
    run: main.Main.add_host_to_blacklist
    description: Adds a single host to the blacklist of connected hosts
    parameters:
      - name: host
        required: true
        type: string
  clear_whitelist:
    run: main.Main.clear_whitelist
    description: Clears the whitelist
  clear_blacklist:
    run: main.Main.clear_blacklist
    description: Clears the blacklist
  graphs from results:
    run: main.graph_from_results
    description: creates json for d3
    parameters:
      - name: nmap_out
        required: true
        type: string
        description: output of run_scan action
    returns:
      Success:
        schema:
          type: object
  run scan:
    run: main.run_scan
    description: Runs an nmap scan and returns the results in XML
    parameters:
      - name: target
        required: true
        type: string
        description: The target (or targets in CIDR notation) to scan
      - name: options
        type: string
    returns:
      Success:
        schema:
          type: object
  scan results as json:
    run: main.scan_results_as_json
    description: transforms nmap results into json
    parameters:
      - name: nmap_out
        required: true
        type: string
        description: output of run_scan action
    returns:
      Success:
        schema:
          type: array
          items:
            type: object
            properties:
              name:
                description: name of the host
                type: string
              address:
                description: address of the host
                type: string
              services:
                description: services on the host
                type: array
                items:
                  type: object
                  properties:
                    port:
                      type: string
                    protocol:
                      type: string
                    state:
                      type: string
                    service:
                      type: string
                    banner:
                      type: string
  scan results as HTML:
    run: main.scan_results_as_html
    description: Returns the scan results from 'run scan' as an HTML table
    parameters:
      - name: results
        required: true
        schema:
          type: array
          items:
            type: object
    returns:
      Success:
        schema:
          type: string

  get active hosts:
    run: main.Main.get_hosts_from_scan
    description: Gets the list of active hosts on a network from an nmap scan
    parameters:
      - name: target
        required: true
        type: string
        description: The target (or targets in CIDR notation) to scan
      - name: options
        type: string
    returns:
      Success:
        schema:
          type: object
          properties:
            host:
              type: string
  run_scan_check_whitelist:
    run: main.Main.run_scan_check_whitelist
    description: Runs a scan and then parses the output for the hosts on the network. It returns the number of hosts
                 found that were not in the whitelist, or 0 if none.
    parameters:
      - name: target
        required: true
        type: string
        description: The target (or targets in CIDR notation) to scan
      - name: options
        type: string
    returns:
      Success:
        schema:
          type: integer
  run_scan_check_blacklist:
    run: main.Main.run_scan_check_blacklist
    description: Runs a scan and then parses the output for the hosts on the network. It returns the number of hosts
                 found that were in the blacklist, or 0 if none.
    parameters:
      - name: target
        required: true
        type: string
        description: The target (or targets in CIDR notation) to scan
      - name: options
        type: string
    returns:
      Success:
        schema:
          type: integer
  ports_and_hosts_from_json:
    run: main.ports_and_hosts_from_json
    description: returns an object with two csv strings 'hosts' and 'ports' from a nmap scan
    parameters:
      - name: string
        required: true
        description: json string or filename
        type: string
      - name: is_file
        default: false
        description: whether or not first input is a filename or not
        type: boolean
    returns:
      Success:
        schema:
          type: string
      NotExists:
        schema:
          type: boolean
      JSONError:
        schema:
          type: boolean