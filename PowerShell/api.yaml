walkoff: '0.1'
info:
  version: 0.1.0
  title: PowerShell app
  description: An app to execute PowerShell commands and scripts locally or remotely
  contact:
    name: Walkoff Team
  license:
    name: Creative Commons
actions:
  Execute Local Command:
    run: app.exec_local_command
    description: Executes the powershell command locally.
    parameters:
    - name: command
      description: list of commands
      required: true
      type: array
    - name: output_filename
      description: file to pipe output to
      type: string
    returns:
      Success:
        schema:
          type: string
      ScriptError:
        failure: true
        schema:
          type: string
      FileError:
        failure: true
        schema:
          type: string
  Execute Remote Command:
    run: app.PowerShell.exec_remote_command
    description: Executes the powershell command on the remote device.
    parameters:
    - name: command
      description: list of commands
      required: true
      type: string
    - name: output_filename
      description: file to pipe output to
      type: string
    returns:
      Success:
        schema:
          type: string
      ScriptError:
        failure: true
        schema:
          type: string
      FileError:
        failure: true
        schema:
          type: string
  Execute Script Remotely:
    run: app.PowerShell.exec_script_remotely
    description: Executes a local script on the remote device
    parameters:
    - name: local_path
      description: path to the script on the local filesystem
      required: true
      type: string
    - name: output_filename
      description: file to pipe output to
      type: string
    returns:
      Success:
        schema:
          type: string
      ScriptError:
        failure: true
        schema:
          type: string
      FileError:
        failure: true
        schema:
          type: string
devices:
  Remote PowerShell Host:
    description: Remote host to run PowerShell scripts/commands on
    fields:
      - name: username
        type: string
        description: Username for remote host
        required: true
      - name: password
        type: string
        description: Password for remote host user
        encrypted: true
        required: true
      - name: host
        description: IP address or hostname of remote host
        type: string
        required: true
      - name: port
        description: WinRM port of remote host
        type: integer
        default: 5986
        minimum: 1
        maximum: 65355
        required: true
      - name: very_insecure_mode_testing_only
        description: disable certificate checking and don't check trust relationship
        type: boolean
